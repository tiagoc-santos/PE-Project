dados$TIME <- as.Date(paste0("01-", dados$MONTH, "-",dados$YEAR), format = "%d-%m-%Y")
ggplot(dados) +
geom_line(aes(x = TIME, y =share , color = COUNTRY))+
geom_point(aes(x = TIME, y = share, color = COUNTRY)) +
scale_x_date(date_labels = "%b %Y") +
scale_y_continuous(limits = c(0,100)) +
scale_color_manual(name = "Country", values = c("green", "blue", "red"))+
labs(title = "Monthly evolution of the share of energy produced from renewable sources",
x = "Time", y = "Share of renewable energy (%)")
set.seed(1950)
n <- 23
result
set.seed(1950)
n <- 23
r <- 300
m <- 170
generate_T_sample <- function() {
Z <- rnorm(n + 1)
T <- sqrt(n) * (Z[1] / sqrt(sum(Z[-1]^2)))
return(T)
}
proportions <- numeric(r)
for (i in 1:r) {
sample_T <- replicate(m, generate_T_sample())
less_or_equal <- subset(sample_T, sample_T <= 1.5)
proportions[i] <- length(less_or_equal)/length(sample_T)
}
mean_proportion <- mean(proportions)
direct_prob <- pt(1.5, df = n)
difference <- abs(mean_proportion - direct_prob) * 100
result <- round(difference * 100, 5)
result
library(ggplot2)
library(readxl)
theme_set(theme_light())
dados <- read_excel("electricity.xlsx", col_types = "text")
countries <- c("IEA Total", "Latvia","Italy")
dados <- subset(dados, COUNTRY %in% countries & YEAR >= 2015 & PRODUCT == "Renewables")
dados$share <- as.numeric(dados$share) * 100
dados$TIME <- as.Date(paste0("01-", dados$MONTH, "-",dados$YEAR), format = "%d-%m-%Y")
View(dados)
ggplot(dados) +
geom_line(aes(x = TIME, y =share , color = COUNTRY))+
geom_point(aes(x = TIME, y = share, color = COUNTRY)) +
scale_x_date(date_labels = "%b %Y") +
scale_y_continuous(limits = c(0,100)) +
scale_color_manual(name = "Country", values = c("green", "blue", "red"))+
labs(title = "Monthly evolution of the proportion of electricity produced from renewable sources",
x = "Time", y = "Share of renewable energy (%)")
setwd("C:/Users/pipos/Desktop/PE")
setwd("C:/Users/pipos/Desktop/PE/Exercicio 3")
ggplot(dados) +
geom_line(aes(x = TIME, y =share , color = COUNTRY))+
geom_point(aes(x = TIME, y = share, color = COUNTRY)) +
scale_x_date(date_labels = "%b %Y") +
scale_y_continuous(limits = c(0,100)) +
scale_color_manual(name = "Country", values = c("green", "blue", "red"))+
labs(title = "Monthly evolution of the proportion of electricity produced from renewable sources",
x = "Time", y = "Share of renewable energy (%)")
library(ggplot2)
library(readxl)
library(ggplot2)
library(readxl)
theme_set(theme_light())
dados <- read_excel("electricity.xlsx", col_types = "text")
countries <- c("IEA Total", "Latvia","Italy")
dados <- subset(dados, COUNTRY %in% countries & YEAR >= 2015 & PRODUCT == "Renewables")
dados$share <- as.numeric(dados$share) * 100
dados$TIME <- as.Date(paste0("01-", dados$MONTH, "-",dados$YEAR), format = "%d-%m-%Y")
ggplot(dados) +
geom_line(aes(x = TIME, y =share , color = COUNTRY))+
geom_point(aes(x = TIME, y = share, color = COUNTRY)) +
scale_x_date(date_labels = "%b %Y") +
scale_y_continuous(limits = c(0,100)) +
scale_color_manual(name = "Country", values = c("green", "blue", "red"))+
labs(title = "Monthly evolution of the proportion of electricity produced from renewable sources",
x = "Time", y = "Share of renewable energy (%)")
View(dados)
View(dados)
set.seed(2822)
lambda_H0 <- 2.90
lambda_H1 <- 3.15
k <-3.234
m <- 5000
n <- 100
test <- function(lambda, k){
x <- rpois(n, lambda = lambda)
mean(x) > k
}
#Rejeita H0
dec_errada_tipo1 <- 0
#Rejeita H1
dec_errada_tipo0 <- 0
for(i in 1:m){
dec_errada_tipo1 <- dec_errada_tipo1 + as.integer(test(lambda_H0, k))
dec_errada_tipo0 <- dec_errada_tipo0 + as.integer(!test(lambda_H1, k))
}
freq_tipo1 <- dec_errada_tipo1 / m
freq_tipo2 <- dec_errada_tipo0 / m
quociente <- freq_tipo2 / freq_tipo1
round(quociente, 2)
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
if(x >= 4.5){
return(theta * x ^(-theta -1) * 4.5^theta)
}
else{
return(0)
}
}
R <- fdp(obs)
for(i %in% obs)
}
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
if(x >= 4.5){
return(theta * x ^(-theta -1) * 4.5^theta)
}
else{
return(0)
}
}
nll <- function(theta){
for(i in obs){
}
}
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
if(x >= 4.5){
return(theta * x ^(-theta -1) * 4.5^theta)
}
else{
return(0)
}
}
nll <- function(theta){
sum <- 0
for(i in obs){
sum <- sum + log(pdf(i,theta))
}
return -sum
}
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
if(x >= 4.5){
return(theta * x ^(-theta -1) * 4.5^theta)
}
else{
return(0)
}
}
nll <- function(theta){
sum <- 0
for(i in obs){
sum <- sum + log(pdf(i,theta))
}
return -sum
}
theta_mle <- mle(log_likelihood, start = list(theta = 3.4))
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
if(x >= 4.5){
return(theta * x ^(-theta -1) * 4.5^theta)
}
else{
return(0)
}
}
nll <- function(theta){
sum <- 0
for(i in obs){
sum <- sum + log(pdf(i,theta))
}
return -sum
}
theta_mle <- mle(nll, start = list(theta = 3.4))
print(i)
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
if(x >= 4.5){
return(theta * x ^(-theta -1) * 4.5^theta)
}
else{
return(0)
}
}
nll <- function(theta){
sum <- 0
for(i in obs){
print(i)
sum <- sum + log(pdf(i,theta))
}
return -sum
}
theta_mle <- mle(nll, start = list(theta = 3.4))
i <- as.numeric(i)
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
if(x >= 4.5){
return(theta * x ^(-theta -1) * 4.5^theta)
}
else{
return(0)
}
}
nll <- function(theta){
sum <- 0
for(i in obs){
i <- as.numeric(i)
sum <- sum + log(pdf(i,theta))
}
return -sum
}
theta_mle <- mle(nll, start = list(theta = 3.4))
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
return(theta * x ^(-theta -1) * 4.5^theta)
}
nll <- function(theta){
sum <- 0
for(i in obs){
i <- as.numeric(i)
sum <- sum + log(pdf(i,theta))
}
return -sum
}
theta_mle <- mle(nll, start = list(theta = 3.4))
traceback
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
return(theta * x ^(-theta -1) * 4.5^theta)
}
sum <- 0
nll <- function(theta){
for(i in obs){
i <- as.numeric(i)
sum <- sum + log(pdf(i,theta))
}
return -sum
}
nll(3.4)
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
return(theta * x ^(-theta -1) * 4.5^theta)
}
sum <- 0
nll <- function(theta){
for(i in obs){
i <- as.numeric(i)
sum <- sum + (pdf(i,theta))
}
return -sum
}
theta_mle <- mle(nll, start = list(theta = 3.4))
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
return(theta * x ^(-theta -1) * 4.5^theta)
}
nll <- function(theta){
sum <- 0
for(i in obs){
i <- as.numeric(i)
sum <- sum + log(pdf(i,theta))
}
return(-sum)
}
theta_mle <- mle(nll, start = list(theta = 3.4))
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
return(theta * x ^(-theta -1) * 4.5^theta)
}
nll <- function(theta){
sum <- 0
for(i in obs){
i <- as.numeric(i)
sum <- sum + (pdf(i,theta))
}
return(-sum)
}
nll(3.4)
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
print(theta * x ^(-theta -1) * 4.5^theta)
return(theta * x ^(-theta -1) * 4.5^theta)
}
nll <- function(theta){
sum <- 0
for(i in obs){
i <- as.numeric(i)
sum <- sum + (pdf(i,theta))
}
return(-sum)
}
nll(3.4)
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
return(theta * x ^(-theta -1) * 4.5^theta)
}
nll <- function(theta){
sum <- 0
for(i in obs){
i <- as.numeric(i)
sum <- sum + (fdp(i,theta))
}
return(-sum)
}
theta_mle <- mle(nll, start = list(theta = 3.4))
View(theta_mle)
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
return(theta * x ^(-theta -1) * 4.5^theta)
}
nll <- function(theta){
sum <- 0
for(i in obs){
i <- as.numeric(i)
sum <- sum + (fdp(i,theta))
}
return(-sum)
}
theta_mle <- mle(nll, start = list(theta = 3.4))
quantile_mle <- qgamma(0.25, shape = theta_mle@coef)
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
return(theta * x ^(-theta -1) * 4.5^theta)
}
nll <- function(theta){
sum <- 0
for(i in obs){
i <- as.numeric(i)
sum <- sum + log(fdp(i,theta))
}
return(-sum)
}
theta_mle <- mle(nll, start = list(theta = 3.4))
quantile_mle <- qgamma(0.25, shape = theta_mle@coef)
View(theta_mle)
true_quantile <- qgamma(0.25, shape = 3.4)
difference <- abs(quantile_mle - true_quantile)
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
return(theta * x ^(-theta -1) * 4.5^theta)
}
nll <- function(theta){
sum <- 0
for(i in obs){
i <- as.numeric(i)
sum <- sum + log(fdp(i,theta))
}
return(-sum)
}
theta_mle <- mle(nll, start = list(theta = 3.4))
quantile_mle <- qgamma(0.25, shape = theta_mle@coef)
true_quantile <- qgamma(0.25, shape = 3.4)
difference <- abs(quantile_mle - true_quantile)
round(diference, 4)
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
return(theta * x ^(-theta -1) * 4.5^theta)
}
nll <- function(theta){
sum <- 0
for(i in obs){
i <- as.numeric(i)
sum <- sum + log(fdp(i,theta))
}
return(-sum)
}
theta_mle <- mle(nll, start = list(theta = 3.4))
quantile_mle <- qgamma(0.25, shape = theta_mle@coef)
true_quantile <- qgamma(0.25, shape = 3.4)
difference <- abs(quantile_mle - true_quantile)
round(difference, 4)
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
return(theta * x ^(-theta -1) * 4.5^theta)
}
nll <- function(theta){
sum <- 0
for(i in obs){
i <- as.numeric(i)
sum <- sum + log(fdp(i,theta))
}
return(-sum)
}
theta_mle <- mle(nll, start = list(theta = 3.4))
quantile_mle <- qgamma(0.25, shape = theta_mle@coef, scale = 4.5)
true_quantile <- qgamma(0.25, shape = 3.4, scale = 4.5)
difference <- abs(quantile_mle - true_quantile)
round(difference, 4)
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
return(theta * x ^(-theta -1) * 4.5^theta)
}
nll <- function(theta){
sum <- 0
for(i in obs){
i <- as.numeric(i)
sum <- sum + log(fdp(i,theta))
}
return(-sum)
}
theta_mle <- mle(nll, start = list(theta = 3.4))
quantile_mle <- qgamma(0.25, shape = theta_mle@coef)
true_quantile <- qgamma(0.25, shape = 3.4)
difference <- abs(quantile_mle - true_quantile)
round(difference, 4)
View(theta_mle)
quantile_mle <- quantile(obs, probs = 0.25)
library(stats4)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
return(theta * x ^(-theta -1) * 4.5^theta)
}
nll <- function(theta){
sum <- 0
for(i in obs){
i <- as.numeric(i)
sum <- sum + log(fdp(i,theta))
}
return(-sum)
}
theta_mle <- mle(nll, start = list(theta = 3.4))
quantile_mle <- qpareto(0.25, shape = theta_hat, scale = 4.5)
install.packages("VGAM")
quantile_mle <- qpareto(0.25, shape = theta_hat, scale = 4.5)
library(VGAM)
install.packages("splines")
install.packages("splines")
library(stats4)
library(VGAM)
library(splines)
quantile_mle <- qpareto(0.25, shape = theta_hat, scale = 4.5)
theta_mle <- mle(nll, start = list(theta = 3.4))
quantile_mle <- qpareto(0.25, shape = theta_mle@coef, scale = 4.5)
library(stats4)
library(VGAM)
library(splines)
n <- 18
obs <- c(8.54,4.76,5.15,4.96,6.25,7.22,12.9,6.04,8.86,4.88,6.54,4.53,4.7,5.38,5.96,5.17,5.09,5.11)
fdp <- function(x, theta){
return(theta * x ^(-theta -1) * 4.5^theta)
}
nll <- function(theta){
sum <- 0
for(i in obs){
i <- as.numeric(i)
sum <- sum + log(fdp(i,theta))
}
return(-sum)
}
theta_mle <- mle(nll, start = list(theta = 3.4))
quantile_mle <- as.numeric(qpareto(0.25, shape = theta_mle@coef, scale = 4.5))
View(theta_mle)
library(ggplot2)
library(readxl)
theme_set(theme_light())
dados <- read_excel("electricity.xlsx", col_types = "text")
countries <- c("IEA Total", "Latvia","Italy")
dados <- subset(dados, COUNTRY %in% countries & YEAR >= 2015 & PRODUCT == "Renewables")
dados$share <- as.numeric(dados$share) * 100
dados$TIME <- as.Date(paste0("01-", dados$MONTH, "-",dados$YEAR), format = "%d-%m-%Y")
ggplot(dados) +
geom_line(aes(x = TIME, y =share , color = COUNTRY))+
geom_point(aes(x = TIME, y = share, color = COUNTRY)) +
scale_x_date(date_labels = "%b %Y") +
scale_y_continuous(limits = c(0,100)) +
scale_color_manual(name = "Country", values = c("green", "blue", "red"))+
labs(title = "Monthly evolution of the proportion of electricity produced from renewable sources",
x = "Time", y = "Share of renewable energy (%)")
View(dados)
